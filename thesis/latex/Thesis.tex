%% ----------------------------------------------------------------
%% Thesis.tex -- MAIN FILE (the one that you compile with LaTeX)
%% ---------------------------------------------------------------- 

% Set up the document
\documentclass[a4paper, 11pt, oneside]{Thesis}  % Use the "Thesis" style, based on the ECS Thesis style by Steve Gunn
\graphicspath{{Figures/}}  % Location of the graphics files (set up for graphics to be in PDF format)

% Include any extra LaTeX packages required
\usepackage[square, numbers, comma, sort&compress]{natbib}  % Use the "Natbib" style for the references in the Bibliography
\usepackage{verbatim}  % Needed for the "comment" environment to make LaTeX comments
\usepackage{vector}  % Allows "\bvec{}" and "\buvec{}" for "blackboard" style bold vectors in maths
\hypersetup{urlcolor=black, colorlinks=true}  % Colours hyperlinks in blue, but this can be distracting if there are many links.
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{framed}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{framed}

%% ----------------------------------------------------------------
\begin{document}
\frontmatter	  % Begin Roman style (i, ii, iii, iv...) page numbering

% Set up the Title Page
\title  {Speculative Loop Parallelization}
\newcommand*{\TITLE}{SPECULATIVE LOOP PARALLELIZATION}
\authors  {\texorpdfstring
            {\href{johannes@jdoerfert.de}{Johannes Doerfert}}
            {Johannes Rudolf Doerfert}
            }
\addresses  {\groupname\\\deptname\\\univname}  % Do not change this here, instead these must be set in the "Thesis.cls" file, please look through it instead
\date       {May 23, 2012}
\subject    {}
\keywords   {}

\maketitle
%% ----------------------------------------------------------------

\setstretch{1.3}  % It is better to have smaller font and larger line spacing than the other way round

% Define the page headers using the FancyHdr package and set up for one-sided printing
\fancyhead{}  % Clears all page headers and footers
\rhead{\thepage}  % Sets the right side header to show the page number
\lhead{}  % Clears the left side page header

\pagestyle{fancy}  % Finally, use the "fancy" page style to implement the FancyHdr headers

%% ----------------------------------------------------------------
% Declaration Page required for the Thesis, your institution may give you a different text to place here
\Declaration{

\addtocontents{toc}{\vspace{1em}}  % Add a gap in the Contents, for aesthetics

\begin{center}
  \bf \large
  Eidesstattliche Erkl\"{a}rung
\end{center}
Ich erkl\"{a}re hiermit an Eides Statt,
dass ich die vorliegende Arbeit selbstst\"{a}ndig verfasst und keine
anderen als die angegebenen Quellen und Hilfsmittel verwendet habe.

\begin{center}
  \bf \large
  Statement in Lieu of an Oath
\end{center}
I hereby confirm that I have written this thesis on my own and 
that I have not used any other media or materials than the ones
referred to in this thesis.

\vfill
\begin{center}
  \bf \large
  Einverst\"{a}ndniserkl\"{a}rung
\end{center}
Ich bin damit einverstanden, dass meine (bestandene) Arbeit in beiden 
Versionen in die Bibliothek der Informatik aufgenommen und damit 
ver\"{o}ffentlicht wird. 

\begin{center}
  \bf \large
  Declaration of Consent
\end{center}
I agree to make both versions of my thesis (with a passing grade) 
accessible to the public by having them added to the library of the
Computer Science Department.

\vfill
\vfill
 
Datum/Date:\\
\rule[1em]{25em}{0.5pt}  % This prints a line to write the date

Unterschrift/Signature:\\
\rule[1em]{25em}{0.5pt}  % This prints a line for the signature
 
}
\clearpage  % Declaration ended, now start a new page

%% ----------------------------------------------------------------
% The "Funny Quote Page"
\pagestyle{empty}  % No headers or footers for the following pages

\null\vfill
% Now comes the "Funny Quote", written in italics
\textit{``Debugging is twice as hard as writing the code in the first place. Therefore, if you write the code as cleverly as possible, you are, by definition, not smart enough to debug it.''}

\begin{flushright}
Brian Kernighan, professor at Princeton University
\end{flushright}

\vfill\vfill\vfill\vfill\vfill\vfill\null
\clearpage  % Funny Quote page ended, start a new page
%% ----------------------------------------------------------------

%\newcommand{\Abstract}{Zusammenfassung}
%% The Abstract Page German
%%\addtotoc{Zusammenfassung}  % Add the "Abstract" page entry to the Contents
%\abstract{
%%\addtocontents{toc}{\vspace{1em}}  % Add a gap in the Contents, for aesthetics

%SPolly, kurz f\"ur spekulatives Polly, ist ein Versuch zwei aktuelle 
%Forschungsprojekte aus dem Bereich des \"Ubersetzerbaus zu kombinieren. 
%Genauer w\"aren das Polly, ein LLVM Projekt um r\"aumliche Datenlokalit\"at und Parallelit\"at
%von regul\"aren Schleifen zu steigern, und Sambamba, welches adaptive Programm\"ubersetzung  erm\"oglicht. Desweiteren geh\"oren Versionsverwaltung, Spekulation
%und Laufzeit Anpassungen zu den Besonderheiten von Sambamba. Als Erweiterung 
%von Polly und mit den M\"oglichkeiten von Sambamba ist SPolly im Stande neuste 
 %Optimierungen und spekulative Parallelisierung auf eine Vielzahl von Schleifen 
 %anzuwenden, sogar bei allgemeinen Anwendungen wie sie zum Beispiel 
 %in der SPEC 2000 Testsammlung zu finden sind. 
 %In solchen Kontexten beinhalten Schleifen
  %nicht (statisch) analysierbare Abh\"angigkeiten und beobachtbare Funktionsaufrufe. 
%Das Potential f\"ur Spekulation h\"angt in solchen F\"allen nicht nur von der 
%Gr\"o\ss{}e der Schleife und der Anzahl der Iterationen ab, sondern auch von der
%Warscheinlichkeit das Abh\"angigkeiten und Funktionsaufrufe auftreten.
%Zusammengefasst findet SPolly vielversprechende Schleifen, parallelisiert diese
%spekulativ und beobachtet das Ergebnis um m\"oglichen Fehlspekulationen entgegenzuwirken.

%Diese Arbeit beschreibt unter welchen Umst\"anden Spekulation m\"oglich ist, 
%wie statische und dynamische Informationen genutzt werden k\"onnen um Fehlspekulationen
%zu vermeiden und wie SPolly sich in die vorhandene Infrastruktur integriert.
%Eine Evaluation mit der SPEC 2000 Testsammlung und verschiedenen
%Versionen des Matrix Multiplikation wird die Ergebnisse und die Vorteile darlegen.

%Diese Arbeit ist in englischer Sprache verfasst.

%}

%\clearpage  % Abstract ended, start a new page

%% ----------------------------------------------------------------
% The Abstract Page
\newcommand{\Abstract}{Abstract}
\addtotoc{Abstract}  % Add the "Abstract" page entry to the Contents
\abstract{
\addtocontents{toc}{\vspace{1em}}  % Add a gap in the Contents, for aesthetics

SPolly, short for speculative Polly, is an attempt to combine two recent research 
projects in the context of compilers. 
There is Polly, an LLVM project to increase data-locality
and parallelism of regular loop nests, and Sambamba, which 
pursues a new, adaptive way of compiling. It offers features like method 
versioning, speculation and runtime adaption. As an extension of the former one
and with the capabilities offered by the latter one,
SPolly can perform state-of-the-art loop optimizations and speculative but sound
loop parallelization on a wide range of loops,
even in general purpose benchmarks as the SPEC 2000 benchmark suite. 
In this context, candidate loops for speculative parallelization may
contain non-computable data dependencies (including possible aliases) 
as well as observable side effects which prohibit  parallelization at first.
The speculative potential of such a candidate loop depends not only on the size and the trip
count, but also on the execution probability of these dependencies and function calls.
Summarized, SPolly detects promising candidate loops, speculatively parallelizes
them and monitors the result to tackle possible misspeculation. 

This thesis will explain under which circumstances speculation is possible,
how static and dynamic information is used to minimize the amount of
misspeculation and how this is integrated into the existing environment of 
Polly and Sambamba. To substantiate the improvements of this work an evaluation on 
SPEC 2000 benchmarks and a case study on different versions of
the matrix multiplication benchmark is presented at the end.

%SPolly, short for speculative Polly, is an attempt to combine two recent research 
%projects in the context of compilers. 
%There is Polly, an LLVM project to increase data-locality
%and parallelism of regular loop nests and Sambamba, which 
%pursues a new, adaptive way of compiling and offers features like method 
%versioning, speculation and runtime adaption. As an extension of the former one
%and with the capabilities offered by the later one,
%SPolly can perform state-of-the-art loop optimizations on a wide range of loops,
%even in general purpose benchmarks as the SPEC 2000 benchmark suite. 
%[CHANGED removed sentence about irreversible function calls an detection of promising loops, added TODO]
%[TODO Should I say something about the ideas for future work ?]
%This thesis will explain under what circumstances speculation is possible,
%how static and dynamic information are used to minimize the amount of
%misspeculation and how this is integrated into the existing environment of 
%Polly and Sambamba. 
%To substantiate the improvements of this work an evaluation on 
%SPEC 2000 benchmarks and a case study on different versions of
%the matrix multiplication benchmark is presented too.


}

\clearpage  % Abstract ended, start a new page
%% ----------------------------------------------------------------

\setstretch{1.3}  % Reset the line-spacing to 1.3 for body text (if it has changed)
\null\vfil
% The Acknowledgements page, for thanking everyone
\acknowledgements{
\addtocontents{toc}{\vspace{1em}}  % Add a gap in the Contents, for aesthetics

  Although I have no ``Loving Wife'' I could thank for keeping the children away,
  there were many friends which helped me to bear the brunt of the work. Especially 
  during the last, indeed frantic days they did their utmost.
  When the only concern is the verging  deadline you may consider yourself lucky
  if you can pass on nearly all other matters. With this in mind it remains to 
  say: Joshua, Ruben and Sarah; Thank you!

  As the daily living is important but not everything when you write your first
  academic contribution, I have to extend special thanks to my advisors. Both of
  them did a heck of a job and endured all my moods and quirks. 
  They were always accessible for questions and helped me in the best possible way 
  during all stages of this work. Furthermore (and in my opinion even more important),
  they encouraged me to structure my work,  something I am admittedly not that good at. 
  From my present view I know it was the best supervision possible.

  Last but not least, I owe special thanks to my supervising professor for the
  liberty he granted me. Even if it took some time to find (or to define) 
  the topic, it was a great experience I would not like to miss. 


}
\clearpage  % End of the Acknowledgements
%% ----------------------------------------------------------------

\pagestyle{fancy}  %The page style headers have been "empty" all this time, now use the "fancy" headers as defined before to bring them back



%% ----------------------------------------------------------------
\lhead{\emph{Contents}}  % Set the left side page header to "Contents"
\dominitoc
\tableofcontents  % Write out the Table of Contents
\clearpage




%% ----------------------------------------------------------------
%\clearpage  % Start a new page
%\lhead{\emph{Physical Constants}}  % Set the left side page header to "Physical Constants"
%\listofconstants{lrcl}  % Include a list of Physical Constants (a four column table)
%{
%% Constant Name & Symbol & = & Constant Value (with units) \\
%Speed of Light & $c$ & $=$ & $2.997\ 924\ 58\times10^{8}\ \mbox{ms}^{-\mbox{s}}$ (exact)\\

%}

%% ----------------------------------------------------------------
%\clearpage  %Start a new page
%\lhead{\emph{Symbols}}  % Set the left side page header to "Symbols"
%\listofnomenclature{lll}  % Include a list of Symbols (a three column table)
%{
%% symbol & name & unit \\
%$a$ & distance & m \\
%$P$ & power & W (Js$^{-1}$) \\
%& & \\ % Gap to separate the Roman symbols from the Greek
%$\omega$ & angular frequency & rads$^{-1}$ \\
%}
%% ----------------------------------------------------------------
% End of the pre-able, contents and lists of things
% Begin the Dedication page

\setstretch{1.3}  % Return the line spacing back to 1.3

\pagestyle{empty}  % Page style needs to be empty for this page
\dedicatory{Dedicated to my father whose never ending patience is priceless.}

\addtocontents{toc}{\vspace{2em}}  % Add a gap in the Contents, for aesthetics


%% ----------------------------------------------------------------
\mainmatter	  % Begin normal, numeric (1,2,3...) page numbering
\pagestyle{fancy}  % Return the page headers back to the "fancy" style

% Include the chapters of the thesis, as separate files
% Just uncomment the lines as you write the chapters
\setcounter{mtc}{4}
\input{./Chapters/Chapter1} % Introduction

\input{./Chapters/Chapter2} % Background Theory 

\input{./Chapters/Chapter3} % Implementation Parts

\input{./Chapters/Chapter4} % Evaluation 

\input{./Chapters/Chapter5} % Results and Discussion

\input{./Chapters/Chapter6} % Case study

\input{./Chapters/Chapter7} % Conclusion

%\input{./Chapters/Chapter} % Future work

%% ----------------------------------------------------------------
% Now begin the Appendices, including them as separate files

%% ----------------------------------------------------------------
\clearpage
\lhead{\emph{List of Figures}}  % Set the left side page header to "List if Figures"
\listoffigures  % Write out the List of Figures

\clearpage
%% ----------------------------------------------------------------
\lhead{\emph{List of Tables}}  % Set the left side page header to "List of Tables"
\listoftables  % Write out the List of Tables
\clearpage

%\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics
%%% ----------------------------------------------------------------
%\setstretch{1.5}  % Set the line spacing to 1.5, this makes the following tables easier to read
%\clearpage  % Start a new page
%\lhead{\emph{Abbreviations}}  % Set the left side page header to "Abbreviations"
%\listofsymbols{ll}  % Include a list of Abbreviations (a table of two columns)
%{
%% \textbf{Acronym} & \textbf{W}hat (it) \textbf{S}tands \textbf{F}or \\
%\textbf{AA} & \textbf{A}lias \textbf{A}nalysis \\
%\textbf{CFG} & \textbf{C}ontrol \textbf{F}low \textbf{G}raph   \\
%\textbf{cloog} & \textbf{C}hunky \textbf{Loo}p \textbf{G}enerator \\
%\textbf{isl} & \textbf{i}nteger \textbf{s}et \textbf{l}ibrary \\
%\textbf{LOC} & \textbf{l}ines \textbf{o}f \textbf{c}ode   \\
%\textbf{LLVM-IR} & LLVM \textbf{I}ntermediate \textbf{R}epresentation  \\
%\textbf{OpenMP} & \textbf{Open} \textbf{M}ulti-\textbf{P}rocessing   \\
%\textbf{Polly} & \textbf{Poly}hedral \textbf{LL}VM   \\
%\textbf{SCoP} & \textbf{S}tatic \textbf{Co}ntrol \textbf{P}art \\
%\textbf{sSCoP} & \textbf{s}peculative \textbf{S}tatic \textbf{Co}ntrol \textbf{P}art \\
%\textbf{SIMD} & \textbf{S}ingle \textbf{I}nstruction \textbf{M}ultiple \textbf{D}ata   \\
%\textbf{SPolly} & \textbf{S}peculative \textbf{P}olly \\
%\textbf{ParCFG} & \textbf{Par}allel \textbf{CFG}   \\
%}
%% ----------------------------------------------------------------
%\lhead{\emph{List of Listings}}  % Set the left side page header to "List of Listings"
%\renewcommand*{\lstlistingname}{List of Listings}
%\lstlistoflistings % Write out the List of Listings 
%\clearpage


\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics

\appendix % Cue to tell LaTeX that the following 'chapters' are Appendices

\input{./Appendices/AppendixA}	% Appendix Title

\input{./Appendices/AppendixB} % Appendix Title

%\input{./Appendices/AppendixC} % Appendix Title

\addtocontents{toc}{\vspace{2em}}  % Add a gap in the Contents, for aesthetics
\backmatter

%% ----------------------------------------------------------------
\label{Bibliography}
\hypersetup{urlcolor=Maroon}  % Colours hyperlinks in blue, but this can be distracting if there are many links.
\lhead{\emph{Bibliography}}  % Change the left side page header to "Bibliography"
\bibliographystyle{unsrtnat}  % Use the "unsrtnat" BibTeX style for formatting the Bibliography
\bibliography{Bibliography}  % The references (bibliography) information are stored in the file named "Bibliography.bib"

\end{document}  % The End
%% ----------------------------------------------------------------
